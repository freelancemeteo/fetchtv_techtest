{% extends 'base.html' %}

{% block content %}

<h2>OMDB lookup</h2>

{# lookup form #}
<form action="" method="POST">
	{% csrf_token %}
	Search for 
	<select name="search_type">
		{% for item in search_types %}
		<option value={{ item.value }} {% if search_type == item.value %}selected{% endif %}>{{ item.name }}</option>
		{% endfor %}
	</select>
	 pertinent to the search term 
	<input type="text" name="search_term" value="{{search_term}}">
	<input type="submit" value="Search">
</form>
<br>
<br>

{# display any error messages provided #}
{% if error %}

    Your search for {{search_type}} with the term '{{search_term}}' failed.
    Please do try again.

{# display results if required, cached using Django cache system #}
{% else %}
	
	{% if show_results %}
		Your search for {{search_type}} with the term '{{search_term}}' has returned {{results|length}} results.
		<br>
		<br>
		<table>
	    <tr>
	        <th align="left">Title</th>
	        <th align="left">Type</th>
	        <th align="left">Year</th>
	        <th align="left">Link to IMDB website</th>
	    </tr>
	    {% for r in results %}
	    <tr> 
	        <td>{{ r.title }}</td>
	        <td>{{ r.ftype }}</td>
	        <td>{{ r.year }}</td>
	        <td><a href="{{ r.link }}">{{ r.link }}</a></td>
	    </tr>
	    {% endfor %}
		</table>

	{% endif %}

{% endif %}

{% endblock %}